---
title: "ShellSIM growth model"
author: "Mariano Viz"
date: "23/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```




```{r}
#Net energy balance function for C. gigas (intitally only considering CHL - i.e., without taking into account POM and POC and, therefore, REMORG, EREM, and NIRREMORG)

net_energy_balance <- function(CHL, NIRREMORG = 0, EREM = 0, TEMP, WE = 1, WS = 1, MNEA = 1350) {
  
  selorg = (CHL*50)/0.38
  nirselorg = (-0.33+(4.11*selorg)) #check table 2 --> TEF and (WE/WS)^0.62
  nea = (((nirselorg*23.5)+(NIRREMORG*0.15*EREM))*0.8*24)
  cr = 0.32+(0.323*TEMP)+(-.011*(TEMP)^2)
  tef = cr/(0.32+(0.323*15)+(-.011*(15)^2)) #check table 2 and check TEM (p.242)!!
  mhl = 4.005*tef*((WE/WS)^0.72) #we/ws???
  thl = mhl + (0.23*nea)
  ON = 10 + (((200-10)/MNEA)*nea)
  el = (((thl/14.06)/16)/ON)*14*1000*24
  neb = nea-thl-(el*0.02428)
  
  
  return(neb)
}

net_energy_balance(CHL =0.2, TEMP = 12)
net_energy_balance(CHL =0, TEMP = 12)


#I'll try to incorporate the other equatins and the dynamics. Once is working I'll copy it in an RScrip, annotate and put it into a subdirectory called R (as if we were going to create a package - thing that we can easily do if it works).

```








```{r}
# Value of information example:


profits = function(E,X, a=1, b=0.1)
{
  profits = a*E*X - b*(X^2)/E
  return(profits)
}

# a = 1
# b = .1
# Elo = 1
# Ehi = 2


# X is the choice (like stocking density)
# E is the environmental variable (like temperature) -- use values around 1 or 2
# Try to find the value of information for this example!



E_norm <- rnorm(mean = 1.5, sd = 0.3, n = 100)
X_lo <- seq(0, 10, length.out=100)
X_hi <- seq(0, 40, length.out=100)
X_norm<- seq(0, 22.5, length.out=100)

profits_lo_df <- data.frame(E_lo = 1, X_lo = X_lo, profits = NA)
profits_hi_df <- data.frame(E_hi = 2, X_hi = X_hi, profits = NA)
profits_norm_df <- data.frame(E_norm = E_norm, X_norm = X_norm, profits = NA)

profits_lo_df$profits <- profits(profits_lo_df$E_lo, profits_lo_df$X_lo)
profits_hi_df$profits <- profits(profits_hi_df$E_hi, profits_hi_df$X_hi)
profits_norm_df$profits <- profits(profits_norm_df$E_norm, profits_norm_df$X_norm)


ggplot()+
  geom_line(data = profits_lo_df, aes(x= X_lo, y=profits))+
  geom_line(data = profits_hi_df, aes(x= X_hi, y=profits))+
  geom_line(data = profits_norm_df, aes(x= X_norm, y=profits))

```
















